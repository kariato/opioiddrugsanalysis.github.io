<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Visualization of the Opioid Crisis in the USA</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="assets/vendors/iconfonts/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="assets/vendors/iconfonts/flag-icon-css/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/vendors/css/vendor.bundle.base.css">
    <link rel="stylesheet" href="assets/vendors/css/vendor.bundle.addons.css">
    <!-- endinject -->
    <!-- plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="assets/css/shared/style.css">
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="assets/css/demo_1/style.css">
    <!-- tool tips -->
    <link rel="stylesheet" href="assets/css/demo_1/d3_tips.css">
    <!-- End Layout styles -->
    <link rel="shortcut icon" href="assets/images/favicon.ico" />

    <style>
        body {
            align-items: center;
        }


    </style>
</head>
<body>
    <div class="container-scroller">
        <!-- partial:partials/_navbar.html -->
        <nav class="navbar default-layout col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
            <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center">
                <a class="navbar-brand brand-logo" href="index.html">
                    <h4>Team #114: Team Big Data</h4>
                </a>
            </div>
            <div class="navbar-menu-wrapper d-flex align-items-center">
                <ul class="navbar-nav">
                    <li class="nav-item font-weight-semibold d-none d-lg-block">
                        <h2>Visualization of the Opioid Crisis in the USA</h2>
                    </li>
                </ul>

            </div>
        </nav>
        <!-- partial -->
        <div class="container-fluid page-body-wrapper">
            <!-- partial:partials/_sidebar.html -->
            <!-- partial -->
            <div class="main-panelx">
                <div class="content-wrapper">

                    <div class="row">
                        <div class="col-md-8 grid-margin stretch-card">
                            <div class="card">
                                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Opioid County Map</h6>
                                </div>
                                <div class="card-body d-flex flex-column">
                                    <div class="template-demo">
                                        <div class="dropdown">
                                            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Year </button>
                                            <div id="selectorsYears" class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                                <h6 class="dropdown-header">Settings</h6>
                                            </div>
                                        </div>
                                        <div class="dropdown">
                                            <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Feature </button>
                                            <div id="selectors" class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                                <h6 class="dropdown-header">Settings</h6>
                                            </div>
                                        </div>
                                        <!--<div id="dashboard-vmap" class="vector-map"></div>-->
                                        <div id="root" >
                                            <div class="row align-items-end">
                                                
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 grid-margin stretch-card">
                            <div class="card">
                                <div class="card-body d-flex flex-column">
                                    <div class="wrapper">
                                        <h4 class="card-title font-weight-bold text-primary mb-0">Location</h4>
                                        <div class="mb-4 font-weight-bold text-primary" id="net-profit-legend">State: Virginia</div>
                                        <div class="mb-4 font-weight-bold text-primary" id="net-profit-legend">County: Fairfax County</div>
                                        <div class="mb-4 font-weight-bold text-primary" id="net-profit-legend">Population: 1,146,000</div>
                                    </div>
                                    The facts<br />
                                    Pills transacted per 100,000 people:
                                    {num_here} <br />
                                    Grams of opioids bought per person:
                                    {num_here}<br />
                                    Etc.<br />
                                    The factors<br />
                                    <div class="mb-4" id="net-profit-legend"><b>Correlate #1:</b> {value for year}</div>
                                    <canvas class="mt-n4" height="90" id="total-revenue"></canvas>
                                    <div class="mb-4" id="net-profit-legend"><b>Correlate #2:</b> {value for year}</div>
                                    <canvas class="mt-n3" height="90" id="total-transaction"></canvas>
                                    <div class="mb-4" id="net-profit-legend"><b>Correlate #3:</b> {value for year}</div>
                                    <canvas class="mt-n4" height="90" id="total-revenue3"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="row">
                                <div class="col-md-6 grid-margin stretch-card">
                                    <div class="card">
                                        <div class="card-body pb-0">
                                            <div class="d-flex justify-content-between">
                                                <h4 class="card-title mb-0">Unemployment</h4>
                                                <p id="unemploymentDelta" class="font-weight-semibold mb-0"></p>
                                            </div>
                                            <h3 id="unemploymentttl" class="font-weight-medium"></h3>
                                        </div>
                                        <canvas class="mt-n4" height="90" id="unemply-chart"></canvas>
                                    </div>
                                </div>
                                <div class="col-md-6 grid-margin stretch-card">
                                    <div class="card">
                                        <div class="card-body pb-0">
                                            <div class="d-flex justify-content-between">
                                                <h4 class="card-title mb-0">Average Deaths</h4>
                                            </div>
                                            <h3 id="ttldeaths" class="font-weight-medium"></h3>
                                        </div>
                                        <canvas class="mt-n3" height="90" id="ttldeathschart"></canvas>
                                    </div>
                                </div>
                                <div class="col-md-6 grid-margin stretch-card">
                                    <div class="card">
                                        <div class="card-body pb-0">
                                            <div class="d-flex justify-content-between">
                                                <h4 class="card-title mb-0">Overdose Deaths</h4>
                                            </div>
                                            <h3 id="ttloddeaths" class="font-weight-medium"></h3>
                                        </div>
                                        <canvas class="mt-n3" height="90" id="ttloddeathschart"></canvas>
                                    </div>
                                </div>
                                <div class="col-md-12 grid-margin">
                                    <div class="card">
                                        <div class="card-body">
                                            <h4 class="card-title mb-0">Market Overview</h4>
                                            <div class="d-flex align-items-center justify-content-between w-100">
                                                <p class="mb-0">Lorem ipsum dolor sit amet consectetur adipisicing elit.</p>
                                                <div class="dropdown">
                                                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="dateSorter" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">This Month</button>
                                                    <div class="dropdown-menu" aria-labelledby="dateSorter">
                                                        <div class="dropdown-item" id="market-overview_1">Daily</div>
                                                        <div class="dropdown-item" id="market-overview_2">Weekly</div>
                                                        <div class="dropdown-item" id="market-overview_3">Monthly</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="d-flex align-items-end">
                                                <h3 class="mb-0 font-weight-semibold">$36,2531.00</h3>
                                                <p class="mb-0 font-weight-medium mr-2 ml-2 mb-1">USD</p>
                                                <p class="mb-0 text-success font-weight-semibold mb-1">(+1.37%)</p>
                                            </div>
                                            <canvas class="mt-4" height="100" id="market-overview-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 grid-margin">
                                    <div class="card">
                                        <div class="p-4 border-bottom bg-light">
                                            <h4 class="card-title mb-0">Mixed Chart</h4>
                                        </div>
                                        <div class="card-body">
                                            <canvas id="mixed-chart" height="100"></canvas>
                                            <div class="mr-5" id="mixed-chart-legend"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 grid-margin stretch-card">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="d-flex align-items-center pb-2">
                                                        <div class="dot-indicator bg-danger mr-2"></div>
                                                        <p class="mb-0">Total Sales</p>
                                                    </div>
                                                    <h4 class="font-weight-semibold">$7,590</h4>
                                                    <div class="progress progress-md">
                                                        <div class="progress-bar bg-danger" role="progressbar" style="width: 78%" aria-valuenow="78" aria-valuemin="0" aria-valuemax="78"></div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 mt-4 mt-md-0">
                                                    <div class="d-flex align-items-center pb-2">
                                                        <div class="dot-indicator bg-success mr-2"></div>
                                                        <p class="mb-0">Active Users</p>
                                                    </div>
                                                    <h4 class="font-weight-semibold">$5,460</h4>
                                                    <div class="progress progress-md">
                                                        <div class="progress-bar bg-success" role="progressbar" style="width: 45%" aria-valuenow="45" aria-valuemin="0" aria-valuemax="45"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 grid-margin stretch-card average-price-card">
                                    <div class="card text-white">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between pb-2 align-items-center">
                                                <h2 class="font-weight-semibold mb-0">4,624</h2>
                                                <div class="icon-holder">
                                                    <i class="mdi mdi-briefcase-outline"></i>
                                                </div>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <h5 class="font-weight-semibold mb-0">Average Price</h5>
                                                <p class="text-white mb-0">Since last month</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
                <!-- content-wrapper ends -->
                <!-- partial:partials/_footer.html -->
                <footer class="footer">
                    <div class="container-fluid clearfix">
                        <span class="text-muted d-block text-center text-sm-left d-sm-inline-block">CSE6242 Project</span>
                        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center"> Team #114</span>
                    </div>
                </footer>
                <!-- partial -->
            </div>
            <!-- main-panel ends -->
        </div>
        <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="assets/vendors/js/vendor.bundle.base.js"></script>
    <script src="assets/vendors/js/vendor.bundle.addons.js"></script>
    <script type="text/javascript" src="assets/js/shared/d3.v5.min.js"></script>
    <script type="text/javascript" src="assets/js/shared/topojson.v2.min.js"></script>
    <script type="text/javascript" src="assets/js/shared/d3-geo-projection.v2.min.js"></script>
    <script type="text/javascript" src="assets/js/shared/d3-legend.min.js"></script>
    <script type="text/javascript" src="assets/js/shared/d3-tip.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://unpkg.com/d3-simple-slider"></script>
    <script src="assets/js/shared/off-canvas.js"></script>
    <script src="assets/js/shared/misc.js"></script>
    <script src="assets/js/D3/County.js"</script>
    <script src="assets/js/D3/dashboard.js"></script>
    <!-- End custom js for this page-->
    <script type="text/javascript">
        var drugs = {};
        var drugTotals = {};
        var drugTotalsFIPS = {};
        var drugTotalsYear = {};
        var coeff1 = {};
        var coeff2 = {};
        var counties = [];
        var states = {};
        var countiesPromise = d3.json("data\\counties-albers-10m.json")
            .then(function (data) {
                counties = data;
            });
        const rollupData = d3.csv("data\\master_rollupv2.csv")
            .then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    padded_key = data[i].FIPS_CODE.padStart(5, 0);
                    if (!(padded_key in drugs)) {
                        drugs[padded_key] = {}
                    }
                    year = data[i].year;
                    Object.keys(data[i]).forEach(function (key) {
                        if (!(key in drugs[padded_key])) {
                            drugs[padded_key][key] = {};
                        };
                        drugs[padded_key][key][year] = data[i][key]
                    });
                }
            });
        const rollupTotalsData = d3.csv("data\\totals.csv")
            .then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    padded_key = data[i].FIPS_CODE.padStart(5, 0);
                    if (!(padded_key in drugTotals)) {
                        drugTotals[padded_key] = {}
                    }
                    Object.keys(data[i]).forEach(function (key) {
                        drugTotals[padded_key][key] = data[i][key]
                    });
                }
            });
        const rollupTotalsFIPSData = d3.csv("data\\totalsfips.csv")
            .then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    padded_key = data[i].FIPS_CODE.padStart(5, 0);
                    if (!(padded_key in drugTotalsFIPS)) {
                        drugTotalsFIPS[padded_key] = {}
                    }
                    Object.keys(data[i]).forEach(function (key) {
                        drugTotalsFIPS[padded_key][key] = data[i][key]
                    });
                }
            });
        const rollupTotalsYearsData = d3.csv("data\\totalsyear.csv")
            .then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    padded_key = data[i].year;
                    if (!(padded_key in drugTotalsYear)) {
                        drugTotalsYear[padded_key] = {}
                    }
                    Object.keys(data[i]).forEach(function (key) {
                        drugTotalsYear[padded_key][key] = data[i][key]
                    });
                }
            });
        const Coeeficients1Data = d3.csv("data\\Coeeficients1.csv")
            .then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    padded_key = data[i].fips.padStart(5, 0);
                    if (!(padded_key in coeff1)) {
                        coeff1[padded_key] = {}
                    }
                    Object.keys(data[i]).forEach(function (key) {
                        coeff1[padded_key][key] = data[i][key]
                    });
                }
            });
        const Coeeficients2Data = d3.csv("data\\Coeeficients2.csv")
            .then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    padded_key = data[i].fips.padStart(5, 0);
                    if (!(padded_key in coeff2)) {
                        coeff2[padded_key] = {}
                    }
                    Object.keys(data[i]).forEach(function (key) {
                        coeff2[padded_key][key] = data[i][key]
                    });
                }
            });
        const FIPSstate = d3.csv("data\\FIPS_STATE.csv")
            .then(function (data) {
                for (var i = 0; i < data.length; i++) {
                    padded_key = data[i].FIPS.padStart(2, 0);
                    states[padded_key] = {
                        'State': data[i].State, 'State_abbr': data[i].State_abbr, 'FIPS':padded_key};

                }
            });

        (function ($) {
            'use strict';
            $(function () {
                Promise.all([counties, rollupData, rollupTotalsData, rollupTotalsFIPSData,
                    rollupTotalsYearsData, Coeeficients1Data, Coeeficients2Data, FIPSstate]).then(values => {
                        if ($("#unemploymentDelta").length) {
                            totalUpdate("00000", "unemployment_rate", '#unemploymentDelta', 'unemply-chart', 'Unemployment', "Percentage");
                        }
                        if ($("#ttldeaths").length) {
                            totalUpdate("00000", "DEATHS_CENSUS", '#ttldeaths', 'ttldeathschart', 'Total Deaths');
                        }
                        if ($("#ttloddeaths").length) {
                            totalUpdate("00000", "All_Overdose_deaths", '#ttloddeaths', 'ttloddeathschart', 'Overdose Deaths');
                        }
                        setupResizeMap();
                    });
            });

        })(jQuery);
    </script>
</body>
</html>